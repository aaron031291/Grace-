"""
Grace AI System Architecture - Visual Hierarchy

                     ┌─────────────────────────────────────────┐
                     │   INTERFACES (External Facing)          │
                     │   REST API | WebSocket | Dashboard      │
                     └────────────────┬────────────────────────┘
                                      ↓
           ┌──────────────────────────────────────────────────┐
           │        LAYER 2: PEER COORDINATION LAYER          │
           │                                                  │
           │    ┌─────────────────┐  ┌─────────────────┐    │
           │    │  MCP Manager    │  │  MetaLearning   │    │
           │    │ (Tool Protocol) │  │  Kernel         │    │
           │    │                 │  │ (Optimization)  │    │
           │    └────────┬────────┘  └────────┬────────┘    │
           └─────────────┼──────────────────────┼────────────┘
                         │        ↓             │
                         └────────┼─────────────┘
                                  ↓
           ┌──────────────────────────────────────────────────┐
           │      LAYER 1: TRIGGER MESH (Orchestration)       │
           │   Event Routing | Workflow Execution | Logging   │
           └────────────────┬─────────────────────────────────┘
                            ↓
           ┌──────────────────────────────────────────────────┐
           │    LAYER 3: CORE KERNELS (Processors)            │
           │                                                  │
           │  Consciousness │ Perception │ Resilience        │
           │  Coordination  │ (Others)   │                   │
           │                                                  │
           └────────────────┬─────────────────────────────────┘
                            ↓
           ┌──────────────────────────────────────────────────┐
           │      LAYER 4: CORE SERVICES                      │
           │                                                  │
           │  Task Manager  │ Communication │ LLM Service    │
           │  Policy Engine │ Trust Ledger  │ Remote Agent   │
           │                                                  │
           └────────────────┬─────────────────────────────────┘
                            ↓
           ┌──────────────────────────────────────────────────┐
           │   LAYER 0: CORE TRUTH LAYER (Source of Truth)    │
           │                                                  │
           │   ┌────────────────────────────────────────┐    │
           │   │  MTL Kernel | Immutable Log | Crypto  │    │
           │   │  System Metrics | KPIs | Trust Scores │    │
           │   └────────────────────────────────────────┘    │
           │                                                  │
           │  ↑↓ All components validate against this layer   │
           │  ↑↓ Source of truth for all system state         │
           └──────────────────────────────────────────────────┘


DATA FLOW:

   User Input
      ↓
   REST/WebSocket API
      ↓
   Task/Event Created
      ↓
   Recorded in Core Truth Layer (MTL, Immutable Log, Metrics)
      ↓
   TriggerMesh Routes Event
      ↓
   Pattern Matching Finds Handlers
      ↓
   MCP & MetaLearning Process (if applicable)
      ↓
   Kernels Activated
      ↓
   Services Execute Actions
      ↓
   Results Recorded in Truth Layer
      ↓
   Dashboard/API Updated
      ↓
   User Receives Updates


INFORMATION FLOW:

   ┌─────────────────────────────────────────┐
   │  All Components Read System State From:  │
   │  - SystemMetrics (KPIs, Trust Scores)   │
   │  - ImmutableTruthLog (Event History)    │
   │  - MTLKernel (Learned Knowledge)        │
   └──────────┬────────────────────────────┬─┘
              │                            │
              ↓                            ↓
        ┌──────────────┐        ┌──────────────┐
        │   Kernels    │        │   Services   │
        │ (Read Only)  │        │  (Read Only) │
        └──────────────┘        └──────────────┘
              │                            │
              ↓                            ↓
              └──────────────┬─────────────┘
                             │
                             ↓
              ┌──────────────────────────┐
              │  TriggerMesh Orchestrates │
              │  Action + Writes Results  │
              └──────────────┬───────────┘
                             │
                             ↓
              ┌──────────────────────────────┐
              │  Core Truth Layer Records    │
              │  All Changes Immutably       │
              └──────────────────────────────┘
"""
